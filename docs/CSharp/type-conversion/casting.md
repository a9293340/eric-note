# Casting

- Casting 是將一個值從一種類型轉換為另一種類型的過程。
- 隱式轉換：用於將值從數值類型轉換為更高的數值類型。例如，`int` 到 `long`。
- 顯式轉換：用於將值從較高的數值類型轉換為較低的數值類型。例如，您可以將一個值從 `long` 轉換為 `int`，或者從 `double` 轉換為 `short`。



## 隱式強制轉換

### 概述

隱式強制轉換是 C# 中類型轉換的一種方式，允許將值從較低的數值類型轉換為較高的數值類型。

### 定義

- **較低類型 (Lower Type)**：需要較少字節數的類型。
- **較高類型 (Higher Type)**：需要更多字節數的類型。

### 例子

- 在 `sbyte` 和 `byte` 中：
  - `sbyte` 需要 1 字節，`short` 需要 2 字節。
  - 因此，`sbyte` 是較低類型，`short` 是較高類型。

- 在 `short` 和 `int` 中：
  - `short` 需要 2 字節，`int` 需要 4 字節。
  - 因此，`short` 是較低類型，`int` 是較高類型。

### 隱式轉換的規則

根據隱式類型轉換的規範，您可以將任何值從 `sbyte` 轉換為以下類型：
- `short`
- `int`
- `long`
- `float`
- `double`
- `decimal`

隱式強制轉換不需要任何特殊語法，語言編譯器會自動處理。

### 示例

假設有一個 `sbyte` 類型的變數 `a`，值為 10，還有一個 `int` 類型的變數 `b`：

```csharp
sbyte a = 10;
int b;
b = a; // 隱式轉換
```

在這種情況下，`a` 的值為 10，`b` 的值也是 10。

### 其他類型的隱式轉換

- 目標類型不僅可以是 `int`，還可以是 `short`、`long`、`float`、`double` 或 `decimal`。
- 例如，將 `sbyte` 隱式轉換為 `double`。

### 錯誤情況

如果使用無效的數據類型，例如 `uint`，將會出現編譯時錯誤，提示“不能隱式轉換類型 'sbyte' 到 'uint'”。

### 注意事項

- `double`、`decimal`、`bool` 和 `string` 不能隱式轉換為其他類型。
- `char` 值可以轉換為 `ushort`、`int` 和其他數值類型，並將使用字符的 ASCII 值進行轉換。

### 示例：`char` 轉換

```csharp
char c = 'a';
int asciiValue = c; // 隱式轉換，asciiValue 將存儲 97
```

這些都是隱式類型轉換的可能情況。


## 顯式強制轉換

### 概述

顯式強制轉換是第二種類型的“類型轉換”。每當我們在括號 `()` 中的源值左側指定目標數據類型時，我們稱之為顯式轉換。這意味著您希望將源值轉換為特定的目標數據類型。

### 顯式轉換的過程

- 手動將源值轉換為目標類型的過程。
- 例如，將值 100 轉換為 `double` 類型：
  ```csharp
  double value = (double)100;
  ```

### 注意事項

- 顯式轉換有時可能導致“松散的轉換”，即如果目標數據類型不足以存儲轉換後的值，該值可能會丟失，並且結果值可能與原始源值略有不同。
- 例如，將值 200 轉換為 `sbyte` 時，由於 `sbyte` 的範圍限制，可能會導致值丟失。

### 使用顯式轉換的情況

1. **在所有隱式轉換的情況下**：
   - 您可以選擇使用顯式轉換或隱式轉換。
   - 例如，將 `int` 轉換為 `float`：
     ```csharp
     int a = 10;
     float b = (float)a; // 顯式轉換
     ```

2. **在顯式轉換表中的情況下**：
   - 這些情況下只能使用顯式轉換，無法使用隱式轉換。
   - 例如，將 `sbyte` 轉換為 `byte`、`ushort`、`uint`、`ulong` 等。

3. **從子類轉換為父類**：
   - 在繼承中，您可以將子類的實例顯式轉換為父類的類型。

### 示例：有損轉換

- 當值為 500 時，由於超出 `sbyte` 的範圍，轉換後的值可能會是近似值，例如 244。
  ```csharp
  int value = 500;
  sbyte b = (sbyte)value; // 有損轉換，b 的值為 244
  ```

### 結論

顯式強制轉換的特性要求開發者在進行轉換時，必須檢查目標類型是否足夠大，以存儲源值。這是顯式類型轉換的基本概念。