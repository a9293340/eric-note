# 解析 (Parsing)

## 概述

解析是“類型轉換”的技術之一，用於將值從“字符串”類型轉換為“數值類型”。使用解析，您可以將字符串值轉換為任何數值類型，如 `sbyte`、`byte`、`short`、`ushort`、`int`、`uint`、`float`、`double`、`decimal` 等。

### 解析的前提條件

- 源值（字符串值）必須只包含數字。
- 不能包含空格、字母或任何其他特殊字符。

## 使用解析的方法

1. **指定目標數據類型**：您應該寫出要轉換的數值類型。
2. **使用 Parse 方法**：編寫 `Parse` 方法，並將源值作為參數傳遞。

### 例子

```csharp
string sourceValue = "100";
int result = int.Parse(sourceValue); // 將字符串轉換為 int
```


- `Parse` 方法將接收源值，並將其轉換為指定的目標類型，然後返回該值。

### 異常處理

- 如果源值無效（例如包含空格、特殊字符或字母），則會引發 `Exception`。
- 例外是運行時錯誤，表示源值無法轉換為指定的目標類型。

#### 示例：無效源值

- 如果源值為 `"10 0"`，由於包含空格，將無法轉換為數值類型，使用 `Parse` 方法會導致運行時錯誤。

## 實際應用

在實時項目中，每當您想將值從 `string` 轉換為任何其他數值類型（如 `int`）時，可以使用 `Parse` 方法，但請確保源值不包含任何無效字符。

### 示例：有效的字符串值

```csharp
string validValue = "100";
int parsedValue = int.Parse(validValue); // 轉換成功
```

- 在這種情況下，`parsedValue` 的值為 `100`，類型為 `int`。

### 字符串與整數的區別

- 雖然從視覺上看，字符串和整數的輸出沒有區別，但它們的操作方式不同：
  - 字符串可以進行連接或使用任何字符串方法。
  - 整數可以進行比較和算術運算（加、減、乘、除、求餘數等）。

### 異常示例

- 如果源值包含空格或字母，例如 `"10 0"`，則 `Parse` 方法會失敗，並引發異常：
  - 錯誤信息：`“输入字符串格式不正确”`。

## 結論

在使用 `Parse` 方法時，請確保源值不包含任何無效字符，如空格、特殊字符或字母，這樣才能成功解析。

# TryParse 方法

## 概述

`TryParse` 方法與 `Parse` 方法基本相同，都是用於將值從 `string` 類型轉換為數值類型。但 `TryParse` 在轉換之前會檢查源值的有效性。

### TryParse 的工作原理

1. **檢查源值**：`TryParse` 方法首先檢查源值是否包含任何字母、空格或特殊字符。
   - 如果源值有效，則進行轉換，並將結果賦值給指定的變數，返回 `true`。
   - 如果源值無效，則不會引發異常，而是將 `out` 變數初始化為該類型的默認值（例如 `0`），並返回 `false`。

### TryParse 的語法

```csharp
bool result = int.TryParse(sourceValue, out int outputValue);
```

- **第一個參數**：要轉換的源值（必須是字符串類型）。
- **第二個參數**：`out` 變數，用於接收轉換後的值。

### 示例

```csharp
string s = Console.ReadLine(); // 從鍵盤讀取輸入
int n;

if (int.TryParse(s, out n)) {
    Console.WriteLine($"轉換成功，值為: {n}");
} else {
    Console.WriteLine("轉換失敗，請檢查輸入的字符。");
}
```

- 如果用戶輸入有效值（如 `500`），則 `n` 將被賦值為 `500`。
- 如果用戶輸入無效值（如 `"10 0"` 或特殊字符），則 `n` 將保持默認值 `0`，並顯示轉換失敗的消息。

## TryParse 的優點

- **避免異常**：`TryParse` 方法自動處理源值的有效性，避免了因無效輸入而導致的異常，從而防止應用程序的突然終止。
- **用於實時項目**：在實時項目中，`TryParse` 方法通常優於 `Parse` 方法，因為我們不總是能確定輸入值的有效性。

## 結論

- 使用 `TryParse` 方法時，您可以安全地處理用戶輸入，避免因無效字符而導致的錯誤。
- 如果您確信源值只包含數字，則可以使用 `Parse` 方法；否則，建議使用 `TryParse` 方法以提高代碼的穩定性。